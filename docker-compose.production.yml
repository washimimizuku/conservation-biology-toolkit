services:
  # Population Analysis - FastAPI Service
  population-analysis:
    build:
      context: ./services/population-analysis
      dockerfile: Dockerfile
    ports:
      - "8002:8000"
    volumes:
      - ./services/population-analysis:/app

  # Sampling & Survey Design - FastAPI Service
  sampling-survey:
    build:
      context: ./services/sampling-survey
      dockerfile: Dockerfile
    ports:
      - "8003:8000"
    volumes:
      - ./services/sampling-survey:/app

  # Genetic Diversity - FastAPI Service
  genetic-diversity:
    build:
      context: ./services/genetic-diversity
      dockerfile: Dockerfile
    ports:
      - "8004:8004"
    volumes:
      - ./services/genetic-diversity:/app

  # Species Assessment - FastAPI Service
  species-assessment:
    build:
      context: ./services/species-assessment
      dockerfile: Dockerfile
    ports:
      - "8005:8005"
    volumes:
      - ./services/species-assessment:/app

  # Habitat & Landscape - FastAPI Service
  habitat-landscape:
    build:
      context: ./services/habitat-landscape
      dockerfile: Dockerfile
    ports:
      - "8006:8006"
    volumes:
      - ./services/habitat-landscape:/app

  # Climate Impact Assessment - FastAPI Service
  climate-impact:
    build:
      context: ./services/climate-impact
      dockerfile: Dockerfile
    ports:
      - "8007:8007"
    volumes:
      - ./services/climate-impact:/app

  # Conservation Planning - FastAPI Service
  conservation-planning:
    build:
      context: ./services/conservation-planning
      dockerfile: Dockerfile
    ports:
      - "8008:8008"
    volumes:
      - ./services/conservation-planning:/app

  # API Gateway/Reverse Proxy
  nginx:
    image: nginx:alpine
    ports:
      - "80:80"
      - "443:443"
    volumes:
      - ./deployment/nginx/api-only.conf:/etc/nginx/conf.d/default.conf
      - ./ssl:/etc/nginx/ssl
    depends_on:
      - population-analysis
      - sampling-survey
      - genetic-diversity
      - species-assessment
      - habitat-landscape
      - climate-impact
      - conservation-planning